(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{256:function(e,t,a){e.exports=a(487)},261:function(e,t,a){},262:function(e,t,a){},291:function(e,t){},487:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(51),o=a.n(c),l=(a(261),a(262),a(33)),i=a(66),s=a.n(i),u=a(101),m=a(23),d={projectName:"Plinx Chat",apiUri:"http://localhost:3030",clientDomain:"http://localhost:3000",authorityDomain:"http://localhost:3030/authentication"},h=a(502),f=a(503),g=a(497),E=a(504),p=a(488),v=a(42),b=a(501),k=a(224),C=a.n(k),w=a(107),y=a.n(w),j=C()(d.apiUri),S=y()();S.configure(y.a.socketio(j)),S.configure(y.a.authentication({storage:window.localStorage}));var O=S,F=function(){var e=Object(n.useState)(),t=Object(m.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(),l=Object(m.a)(o,2),i=l[0],s=l[1],u=function(e,t){"email"===e?c(t.target.value):"password"===e&&s(t.target.value)},k=function(){return O.authenticate({strategy:"local",email:a,password:i}).then((function(e){return console.log(e)})).catch((function(e){return console.error("Something went wrong "+e)}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{textAlign:"center",style:{height:"100vh"},verticalAlign:"middle"},r.a.createElement(h.a.Column,{style:{maxWidth:450,opacity:"0.92"}},r.a.createElement(f.a,{as:"h2",style:{color:"white"},textAlign:"center"},"Log-in to ",d.projectName),r.a.createElement(g.a,{onSubmit:k,size:"large"},r.a.createElement(E.a,{stacked:!0},r.a.createElement(g.a.Input,{required:!0,fluid:!0,icon:"user",iconPosition:"left",placeholder:"E-mail address",onChange:function(e){return u("email",e)}}),r.a.createElement(g.a.Input,{required:!0,fluid:!0,icon:"lock",iconPosition:"left",placeholder:"Password",type:"password",onChange:function(e){return u("password",e)}}),r.a.createElement(p.a,{className:"login-element",color:"teal",fluid:!0,size:"large"}," Login"),r.a.createElement("br",null))),r.a.createElement(p.a,{className:"login-element",color:"teal",fluid:!0,size:"large"}," ",r.a.createElement("small",null,"Continue as guest")),r.a.createElement(E.a,{className:"login-element"},r.a.createElement("a",{href:"http://localhost:3030/oauth/github",target:"_blank"}," ",r.a.createElement(v.a,{className:"github"})," ",r.a.createElement("small",null,"Login with github"))),r.a.createElement(E.a,{className:"login-element"},r.a.createElement("a",{href:"http://localhost:3030/oauth/google",target:"_blank"}," ",r.a.createElement(v.a,{className:"google"})," ",r.a.createElement("small",null,"Login with google"))),r.a.createElement("br",null),r.a.createElement(b.a,{className:"login-element"},"New to us? ",r.a.createElement("a",{onClick:function(){return O.service("users").create({email:a,password:i}).then((function(){return k()}))},href:"#"},"Sign Up")))))},x=a(81),D=a(500),A=a(245),I=function(e){var t=e.users,a=e.onLogout;return n.createElement(E.a,{style:{backgroundColor:"rgba(0,0,0,0.5)"}},n.createElement(x.a,{as:"a",color:"teal",ribbon:!0},t&&t.length," active users"),n.createElement(D.a,null,t&&t.map((function(e){return n.createElement(D.a.Item,null,n.createElement(A.a,{avatar:!0,src:e.avatar,alt:e.email}),n.createElement(D.a.Content,null,n.createElement(D.a.Header,{style:{color:"white"}},e.email?e.email:"Guest")))}))),n.createElement("footer",null,n.createElement("a",{href:"#",onClick:a},"Sign Out")))},L=a(237),N=a.n(L),B=function(e){var t=e.messages;return n.createElement(E.a,{style:{height:"80vh",overflow:"auto",backgroundColor:"rgba(0,0,0,0.5)"}},n.createElement("main",{ref:function(e){e}},t&&t.map((function(e){return n.createElement("div",{key:e._id},n.createElement(b.a,{color:"black",style:{backgroundColor:"rgba(50,50,50,0.9)"},image:!0},n.createElement(b.a.Content,null,n.createElement(b.a.Header,null," ",n.createElement(A.a,{avatar:!0,src:e.user.avatar}),e.user.email," - ",n.createElement("small",null,N()(e.createdAt).format("MMM Do, hh:mm:ss"))),n.createElement(x.a,{basic:!0,pointing:!0}," ",e.text))))}))))},U=a(496),P=function(e){var t=e.sendMessage;return n.createElement(g.a,{onSubmit:t,id:"send-message"},n.createElement(U.a,{action:{color:"teal",labelPosition:"right",icon:"send",content:"Send"},Icon:!0,fluid:!0,type:"text",name:"text"}))},$=a(246),_=a(238),q=a.n(_),W=a(499),z=a(239),M=function(e){var t,a=Object(n.useState)(""),c=Object(m.a)(a,2),o=c[0],l=c[1],i=Object(n.useState)(8),s=Object(m.a)(i,2),u=s[0],d=s[1],h=e.onUpdateSketchInfor,f=e.activeUserId,g=e.users,E=e.setCahedUserSketch,p=e.cahedUserSketch,b=e.sketchInfo;Object(n.useEffect)((function(){O.service("sketches").on("created",(function(e){return k(e)}))}),[]);var k=function(e){e.data.userId!==f&&(t.stroke(e.data.c),t.strokeWeight(e.data.w),t.line(e.data.x,e.data.y,e.data.px,e.data.py))};return r.a.createElement("div",{style:{width:"500px",height:"500px",cursor:"crosshair"}},r.a.createElement(W.a,{trigger:r.a.createElement(v.a,{name:"eye dropper",style:{position:"absolute",right:"5%",top:"30px"},color:"red",size:"large"}),on:"click",content:r.a.createElement(z.SketchPicker,{color:o,onChangeComplete:function(e){l(e.hex)}})}),r.a.createElement(W.a,{trigger:r.a.createElement(v.a,{name:"pencil",style:{position:"absolute",right:"5%",top:"80px"},color:"red",size:"large"}),on:"click",content:r.a.createElement(U.a,{min:"1",max:"50",label:"px",labelPosition:"right",value:u,onChange:function(e,t){var a=t.value;d(parseInt(a))},type:"number"})}),r.a.createElement(q.a,{setup:function(e,a){t=e,e.frameRate(30),e.createCanvas(820,500).parent(a),e.strokeWeight(u),e.background("#272822");var n=!0,r=!1,c=void 0;try{for(var o,l=function(){var t=o.value;g.find((function(e){return e._id===t.userId}));e.stroke(t.c),e.line(t.x,t.y,t.px,t.py)},i=b[Symbol.iterator]();!(n=(o=i.next()).done);n=!0)l()}catch(s){r=!0,c=s}finally{try{n||null==i.return||i.return()}finally{if(r)throw c}}},mouseDragged:function(e,t){var a={x:e.mouseX,y:e.mouseY,px:e.pmouseX,py:e.pmouseY,userId:f,w:u,c:o};h(a),E([].concat(Object($.a)(p),[a])),e.stroke(o),e.strokeWeight(u),e.line(e.mouseX,e.mouseY,e.pmouseX,e.pmouseY)}}))},X=a(242),Y=a.n(X),H=(a(484),a(485),function(e){var t=e.apiData,a=e.uid,c=Object(n.useState)(""),o=Object(m.a)(c,2),l=o[0],i=o[1];Object(n.useEffect)((function(){i(e.apiData.c||"")}),[]);var d=function(){var e=Object(u.a)(s.a.mark((function e(){var n,r,c=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=c.length>0&&void 0!==c[0]?c[0]:"",r={uid:a,c:n},O.service("code").update(t._id,r),i(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Y.a,{style:{width:"100%"},mode:"javascript",theme:"monokai",onChange:d,name:"code-editor",value:t.uid!=a?t.c:l,highlightActiveLine:!0,editorProps:{$blockScrolling:!0}})}),J={windowLabels:{cursor:"pointer"}},R=function(e){var t=e.users,a=e.messages,c=e.userId,o=e.sketchList,l=e.codeList,i=e.getSketchDataFromApi,s=Object(n.useState)("Chat"),u=Object(m.a)(s,2),d=u[0],f=u[1],g=Object(n.useState)([]),E=Object(m.a)(g,2),p=E[0],v=E[1],b=function(){},k=function(e){return O.service("sketches").create({data:e})};Object(n.useEffect)((function(){O.service("messages").on("created",b)}),[]),Object(n.useEffect)((function(){return function(){O.service("messages").removeListener("created",b)}}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement(h.a,null,r.a.createElement(h.a.Row,null,r.a.createElement(h.a.Column,{width:1}),r.a.createElement(h.a.Column,{width:4},r.a.createElement(I,{onLogout:function(){return O.logout()},users:t})),r.a.createElement(h.a.Column,{width:10},r.a.createElement(x.a,{style:J.windowLabels,color:"Chat"===d?"teal":"grey",onClick:function(){return f("Chat")}},"Chat"),r.a.createElement(x.a,{style:J.windowLabels,color:"Sketch"===d?"teal":"grey",onClick:function(){i().then((function(){f("Sketch")}))}},"Sketch"),r.a.createElement(x.a,{style:J.windowLabels,color:"Code"===d?"teal":"grey",onClick:function(){return f("Code")}},"Code"),function(){switch(d){case"Chat":return r.a.createElement(B,{messages:a});case"Sketch":return r.a.createElement(M,{users:t,activeUserId:c,sketchInfo:o,onUpdateSketchInfor:k,cahedUserSketch:p,setCahedUserSketch:v});case"Code":return r.a.createElement(H,{uid:c,apiData:l})}}(),r.a.createElement(P,{sendMessage:function(e){f("Chat");var t=e.target.querySelector('[name="text"]'),a=t.value.trim();a&&O.service("messages").create({text:a}).then((function(){t.value=""})),e.preventDefault()}}))))))},G=["#FF99E6","#CCFF1A","#FF1A66","#E6331A","#33FFCC","#66994D","#B366CC","#4D8000","#B33300","#CC80CC","#66664D","#991AFF","#E666FF","#4DB3FF","#1AB399","#E666B3","#33991A","#CC9999","#B3B31A","#00E680","#4D8066","#809980","#E6FF80","#1AFF33","#999933","#FF3380","#CCCC00","#66E64D","#4D80CC","#9900B3","#E64D66","#4DB380","#FF4D4D","#99E6E6","#6666FF"],K=!1,Q=function(){var e=Object(n.useState)(),t=Object(m.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),l=Object(m.a)(o,2),i=l[0],d=l[1],h=Object(n.useState)([]),f=Object(m.a)(h,2),g=f[0],E=f[1],p=Object(n.useState)([]),v=Object(m.a)(p,2),b=v[0],k=v[1],C=Object(n.useState)({}),w=Object(m.a)(C,2),y=w[0],j=w[1],S=O.service("messages"),x=O.service("users"),D=O.service("sketches"),A=O.service("code");Object(n.useEffect)((function(){O.authenticate().catch((function(){return c({})})),O.on("authenticated",(function(e){K=!0,Promise.all([S.find({query:{$sort:{createdAt:-1},$limit:25}}),x.find(),A.find({query:{$limit:1}})]).then((function(t){var a=Object(m.a)(t,3),n=a[0],r=a[1],o=a[2],l=n.data.reverse(),i=r.data,s=o.data;if(c(e),d(l),E(i),s.length>0)j(s[0]);else{var u={c:"",uid:i._id};O.service("code").create(u).then((function(e){j(e)}))}I()}))})),O.on("logout",(function(){c({}),d([]),E([]),k([]),j({}),K=!1})),S.on("created",(function(e){d(i.concat(e))})),A.on("updated",(function(e){return j(e)})),D.on("created",(function(e){return k(b.concat(e))})),x.on("created",(function(e){return E(g.concat(e))}))}),[i]);var I=function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.find({query:{$sort:{createdAt:-1},$limit:5e3}}).then((function(e){for(var t=e.data,a=0;a<g.length;a++)g[a].sketchColour=a>G.length?"#ffffff":G[a];for(var n=[],r=0;r<t.length;r++)n.push(t[r].data);k(n)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return void 0===a?r.a.createElement("main",{className:"container text-center"},r.a.createElement("h1",null,"Loading...")):K?r.a.createElement(r.a.Fragment,null,r.a.createElement(R,{getSketchDataFromApi:I,messages:i,users:g,sketchList:b,codeList:y,userId:a.user?a.user._id:""})):r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null))},T=function(){var e=n.createElement(n.Fragment,null,n.createElement(l.a,{exact:!0,path:"/",component:Q}));return n.createElement(l.c,null,e)},V=function(){return r.a.createElement("div",null,r.a.createElement(T,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Z=a(244);o.a.render(r.a.createElement(Z.a,null,r.a.createElement((function(){return n.createElement("div",{className:"video-container"})}),null),r.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[256,1,2]]]);
//# sourceMappingURL=main.d91226f1.chunk.js.map